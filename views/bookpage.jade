extends layout
append css
  link(rel="stylesheet", href="/stylesheets/main.css")

append content
  .navbar.navbar-static-top
    .container-fluid
      .nav.navbar-form
        .row
          .btn-toolbar.pull-left
            .btn-group
              button.btn.btn-default(data-bind="click:function(){}")
                | switch notebook

          .btn-toolbar.pull-left(data-bind="if : current_notebook", style="margin-left:10px")
            .btn-group
              button.btn.btn-default(data-bind="click:function(){ current_notebook().exec() }")
                | exec notebook
              button.btn.btn-default(data-bind="click:function(){ current_notebook().add_note()}")
                | add note

          .btn-toolbar.pull-left(data-bind="if : current_note", style="margin-left:10px")
            .btn-group
              button.btn.btn-default(data-bind="click:function(){ current_notebook().insert( current_note()) }")
                | insert note before
              button.btn.btn-default(data-bind="click:function(){ current_note().exec() }")
                | exec note
              button.btn.btn-default(data-bind="click:function(){ current_notebook().delete(current_note()) }")
                | delete note

  hr.navhr

  +ko('if : current_notebook')
    .container-fluid(data-bind='foreach : current_notebook().notes')
      .note(data-bind="css:{\
                          'current' : $data == $root.current_note()\
                      },\
                      click : function(){ $root.current_note($data) }")
        .row
          .col-xs-12
            .editor(data-bind="editor")

          +ko('if : $data.res')
            .res-container(data-bind='with : $data.res')
              each res in ['stdout','stderr','exceptions','exports']
                .row(data-bind="if : $data.#{res} && #{res}.length")

                  .col-xs-1
                    .res_label=res
                  .col-xs-11
                    pre(data-bind="text : #{res}")


append js
  script(type="application/javascript", src="//cdn.staticfile.org/ace/1.1.3/ace.js")
  script(type="application/javascript", src="//cdn.staticfile.org/ace/1.1.3/ext-language_tools.js")
  script.
    var notes = !{JSON.stringify(notes || [])};
  script(src="/javascripts/bookpage.js")
